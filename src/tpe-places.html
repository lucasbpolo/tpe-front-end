<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/iron-icons/editor-icons.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">

<link rel="import" href="shared-styles.html">

<dom-module id="tpe-places">
  <template>
    <style include="shared-styles">
      :host {
        display: block;

        padding: 10px;
      }

      .title-holder{
        display: flex;
        align-items: center;

      }

        .title{
          display: flex;
          flex: 1;
          margin: 24px;
        }

        .create-button{
          color: #FFF;
          background-color: #4B6CAB;
          margin: 24px;
        }
      
      .list{
        list-style-type: none;
        margin: 0;
        padding: 0;

        margin: 24px;
        color: #757575;
        border-radius: 5px;
        background-color: #fff;
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
      }

        .item{
          display: flex;
          border-bottom: 1px solid #e5e5e5;
          padding: 10px 18px;
          cursor: pointer;
        }

        .item:last-of-type{
          border-bottom: none;
        }

          .item-name-link{
            display: flex;
            flex: 1;
            align-items: center;
          }

            .item-name{

            }

          .item-icons{}

            .edit-icon{}

    </style>
    
    <div class="title-holder">
      <h1 class="title">Pontos</h1>
      <paper-button class="create-button" raised on-tap="_openCreate">NOVO</paper-button>
    </div>

    <ul class="list">
      <template is="dom-repeat" items="{{places}}">
        <li class="item">
          <a class="item-name-link" href="/places-detail/{{item.id}}">
            <span class="item-name">{{item.name}}</span>
          </a>
          <span class="item-icons">
            <paper-icon-button class="edit-icon" icon="editor:mode-edit" on-tap="_openEdit"></paper-icon-button>
          </span>
        </li>
      </template>
    </ul>

  </template>

  <script>
    Polymer({
      is: 'tpe-places',
      properties: {
        places: {
          type: Array,
          value: function(){
            return [
              {
                name: 'ponto 1',
                id: 1,
                local: 'treze de maio',
                field1: 'teste',
                field2: 'outro teste'
              },
              {
                name: 'ponto 2',
                id: 2,
                local: 'nome da rua',
                field1: 'teste',
                field2: 'outro teste'
              },
              {
                name: 'ponto 3',
                id: 3,
                local: 'outra rua',
                field1: 'teste',
                field2: 'outro teste'
              },
              {
                name: 'ponto 4',
                id: 4,
                local: 'mais um nome de rua',
                field1: 'teste',
                field2: 'outro teste'
              },
              {
                name: 'ponto 5',
                id: 5,
                local: 'rua rua rua',
                field1: 'teste',
                field2: 'outro teste'
              },
              {
                name: 'ponto 6',
                id: 6,
                local: 'campos sales',
                field1: 'teste',
                field2: 'outro teste'
              }
            ];
          }
        }
      },

      _openEdit: function(e){
        var that = this;
        var index = e.model.index;
        
        this.fire('open-tpe-modal', {
          modalTitle: 'Edição do ponto - '+ this.places[index].name,
          element: 'tpe-modal-create-edit-places',
          cancelLabel: 'CANCELAR',
          confirmLabel: 'SALVAR',
          payload: this.places[index],
          onCancel: function(data){ },
          onConfirm: function(data){
            that.set('places.' + index, data);
          }
        });
      },

      _openCreate: function(){
        var that = this;
        
        this.fire('open-tpe-modal', {
          modalTitle: 'Criação de ponto',
          element: 'tpe-modal-create-edit-places',
          cancelLabel: 'CANCELAR',
          confirmLabel: 'CRIAR',
          payload: {},
          onCancel: function(data){ },
          onConfirm: function(data){
            that.unshift('places', data);
          }
        });
      }
    });
  </script>
</dom-module>
